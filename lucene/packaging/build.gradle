/*
 * Licensed to the Apache Software Foundation (ASF) under one or more
 * contributor license agreements.  See the NOTICE file distributed with
 * this work for additional information regarding copyright ownership.
 * The ASF licenses this file to You under the Apache License, Version 2.0
 * (the "License"); you may not use this file except in compliance with
 * the License.  You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

// This project puts together a "distribution", assembling dependencies from
// various other projects.

plugins {
    id 'distribution'
}

description = 'Lucene packaging'

distributions {
    main {
        distributionBaseName = 'lucene'

        contents {
            // Manually correct posix permissions (matters when packaging on Windows).
            filesMatching(["**/*.sh", "**/*.bat"]) { copy ->
                copy.setMode(0755)
            }

            from(project(':lucene').projectDir, {
                include "README.md"
                include "LICENSE.txt"
                include "NOTICE.txt"
                include "MIGRATE.md"
                include "JRE_VERSION_MIGRATION.md"
                include "SYSTEM_REQUIREMENTS.md"
                include "CHANGES.txt"
                include "licenses/*"
            })

            from(project(':lucene:luke').projectDir, {
                include 'bin/*'  // need to strip prefix here

                into 'luke'
            })

            // TODO:
            // module jars
            // docs/[subproject]/*
            // queryparser/docs/*
            // module/lib jars

//       This was copied from ANT and remains to be implemented
//            from(project.buildDir, {
//                include "docs/"
//                include "**/*.jar"
//                include "**/*.war"
//                exclude "**/*-sources.jar" // was: *-src.jar
//                exclude "**/*-sources.war"
//                // TODO also *-javadoc.jar ?
//            })
//
//            from(project.projectDir, {
//                include "**/lib/*.jar"
//                include "*/docs/"
//                include "**/README*"
//                exclude "*/build/**"
//                exclude "site/**"
//                exclude "tools/**"
//                exclude "**/lib/*servlet-api*.jar"
//                exclude "dev-docs/**"
//            })
        }
    }
}
